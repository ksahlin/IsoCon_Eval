# IsoCon_Eval
Evaluation scripts for IsoCon + targeted sequencing approach.

Folder structure should mimic the format in [evaluation google doc](https://docs.google.com/document/d/1Qx_jhRixbQi0Y1_QCYXpn9T5Z8NXLsAPb6-_bd7LDdw/edit) under "Proposed Analyses
"

# Running script for analysis 1:

    python get_illumina_supported_variants.py -illumina_to_ref /ROOT/PATH/TO/Isocon_EVAL/Nucl_level_analysis/ref/TSPY_sample1_aln_after_rmdup.bam -illumina_to_pred /ROOT/PATH/TO/Isocon_EVAL/Nucl_level_analysis/Tofu/TSPY_sample1_aln_after_rmdup.bam -reference /ROOT/PATH/TO/Isocon_EVAL/Nucl_level_analysis/fasta_refs/TSPY_consensus.fa -predicted /ROOT/PATH/TO/Isocon_EVAL/Nucl_level_analysis/Tofu/TSPY_sample1.fa  -outfolder  /ROOT/PATH/TO/OUTPUT/TOFU_TSPY_sample1 --variant_cutoff 2   
    
The output will be in the folder `/ROOT/PATH/TO/OUTPUT/TOFU_TSPY_sample1/`. In addition, some summary stats are written to output, and from the run above, looks like this:



    FINAL STATS FROM RUN BELOW


    ('Total variant carrying reads:', 8742)
    ('Total number of illumina supported sites:', 1478)
    ('Number of variant carrying reads that were unmapped on predicted:', 41)
    (22, 22)
    ('Deletion sites captured:', 27)
    ('Insertion sites captured:', 2)
    ('Substitution sites captured:', 22)


    ('Deletion sites not captured:', 0)
    ('Insertion sites not captured:', 7)
    ('Substitution sites not captured:', 1420)
    deletions captured depths:
    [4, 5, 2, 2, 13, 4, 6, 2, 3, 2, 8, 2, 2, 3, 2, 4, 2, 2, 2, 2, 2, 2, 2, 2, 7, 7, 4]
    deletions not captured depths:
    []


    insertions captured depths:
    [94, 5]
    insertions not captured depths:
    [2, 2, 2, 5, 2, 2, 2]


    substitutions captured depths:
    [58, 233, 4, 73, 4, 136, 63, 23, 155, 4, 52, 8, 8, 1498, 7, 10, 11, 1519, 3, 32, 2, 15]
    substitutions not captured depths:
    [2, 20, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 3, 2, 2, 3, 2, 4, 3, 2, 2, 8, 8, 2, 3, 2, 3, 2, 2, 2, 2, 2, 3, 3, 2, 4, 2, 2, 4, 2, 2, 2, 3, 2, 4, 2, 2, 3, 3, 2, 4, 2, 4, 10, 2, 2, 6, 2, 3, 3, 2, 3, 5, 2, 4, 3, 6, 3, 7, 2, 2, 5, 2, 4, 2, 3, 2, 3, 35, 4, 28, 2, 17, 6, 2, 3, 2, 2, 2, 2, 3, 2, 2, 3, 2, 2, 4, 2, 2, 4, 3, 2, 2, 2, 3, 2, 3, 6, 2, 72, 46, 94, 2, 5, 122, 5, 8, 9, 3, 13, 2, 2, 108, 22, 9, 4, 2, 9, 28, 7, 3, 12, 5, 5, 5, 2, 34, 2, 53, 20, 2, 2, 6, 29, 5, 3, 28, 6, 2, 4, 2, 2, 2, 3, 2, 4, 7, 2, 2, 2, 2, 4, 3, 2, 3, 2, 86, 6, 19, 2, 2, 4, 9, 4, 4, 2, 2, 4, 4, 106, 4, 6, 10, 4, 2, 10, 2, 2, 6, 4, 93, 2, 5, 14, 6, 7, 2, 5, 4, 3, 27, 2, 6, 2, 3, 498, 3, 6, 2, 2, 2, 72, 2, 5, 3, 6, 5, 3, 83, 4, 3, 5, 24, 3, 10, 17, 6, 5, 3, 2, 16, 5, 6, 2, 2, 5, 10, 2, 4, 2, 3, 3, 2, 6, 75, 10, 4, 13, 4, 28, 4, 12, 5, 2, 2, 3, 12, 98, 3, 2, 3, 6, 93, 3, 3, 2, 18, 26, 22, 2, 6, 2, 81, 8, 3, 3, 4, 16, 11, 2, 2, 7, 7, 2, 10, 87, 7, 10, 5, 17, 7, 13, 4, 11, 3, 2, 7, 3, 7, 5, 3, 5, 11, 40, 7, 3, 2, 2, 32, 6, 3, 3, 2, 3, 4, 34, 3, 9, 2, 4, 3, 12, 49, 7, 2, 19, 4, 2, 2, 6, 4, 4, 43, 3, 3, 49, 5, 16, 7, 6, 7, 5, 6, 2, 42, 2, 4, 17, 7, 4, 10, 2, 3, 14, 3, 6, 2, 4, 4, 28, 3, 9, 4, 2, 12, 11, 2, 2, 4, 2, 4, 3, 16, 83, 2, 3, 12, 4, 2, 13, 3, 2, 16, 9, 3, 4, 2, 28, 20, 10, 9, 7, 13, 7, 50, 2, 2, 3, 21, 7, 4, 2, 2, 6, 2, 53, 2, 4, 9, 3, 2, 7, 2, 5, 35, 8, 3, 2, 2, 4, 14, 25, 2, 12, 7, 7, 13, 2, 3, 2, 5, 3, 7, 6, 2, 4, 2, 2, 47, 4, 13, 6, 4, 4, 54, 2, 14, 2, 8, 3, 3, 5, 13, 13, 5, 3, 6, 5, 3, 15, 6, 2, 2, 7, 26, 3, 7, 2, 2, 3, 11, 2, 23, 7, 4, 7, 4, 12, 10, 17, 8, 5, 5, 7, 6, 5, 4, 9, 8, 2, 2, 20, 44, 20, 4, 21, 7, 6, 13, 6, 7, 6, 6, 4, 16, 13, 9, 35, 8, 2, 19, 3, 2, 3, 4, 6, 10, 4, 2, 4, 16, 33, 6, 10, 3, 12, 7, 7, 3, 46, 6, 3, 4, 7, 16, 4, 3, 2, 2, 4, 3, 56, 10, 10, 5, 4, 25, 3, 2, 4, 4, 5, 6, 7, 2, 3, 5, 6, 9, 12, 2, 2, 50, 4, 12, 4, 2, 3, 5, 4, 3, 4, 11, 18, 7, 3, 10, 5, 9, 8, 16, 8, 6, 10, 10, 4, 7, 2, 24, 10, 5, 2, 13, 10, 3, 16, 11, 8, 10, 8, 17, 4, 22, 3, 7, 9, 10, 5, 4, 6, 7, 3, 19, 3, 19, 4, 10, 15, 17, 3, 14, 4, 3, 4, 6, 34, 22, 6, 9, 24, 4, 19, 9, 5, 5, 11, 3, 6, 2, 17, 4, 29, 6, 2, 23, 11, 5, 20, 9, 32, 4, 17, 9, 14, 2, 14, 2, 3, 13, 4, 12, 11, 3, 21, 8, 14, 3, 3, 9, 13, 3, 8, 4, 3, 14, 2, 9, 6, 8, 18, 5, 7, 3, 3, 2, 13, 15, 8, 18, 4, 33, 10, 10, 5, 2, 29, 5, 3, 4, 2, 16, 10, 8, 2, 8, 2, 13, 4, 4, 18, 3, 5, 8, 18, 7, 22, 5, 3, 3, 5, 5, 25, 2, 2, 8, 6, 8, 4, 16, 3, 20, 3, 7, 14, 4, 4, 17, 7, 13, 2, 14, 2, 6, 4, 3, 5, 12, 3, 7, 6, 17, 2, 5, 8, 4, 3, 9, 8, 27, 3, 6, 7, 2, 9, 21, 45, 7, 6, 2, 2, 5, 5, 437, 4, 5, 18, 6, 2, 6, 14, 3, 3, 12, 2, 4, 6, 2, 21, 5, 4, 3, 18, 2, 22, 4, 2, 2, 4, 11, 5, 2, 4, 17, 6, 5, 3, 4, 9, 10, 3, 5, 5, 3, 26, 6, 3, 17, 26, 12, 4, 2, 10, 5, 15, 8, 5, 6, 14, 13, 5, 12, 2, 4, 9, 3, 9, 8, 2, 8, 8, 3, 19, 6, 2, 13, 6, 6, 15, 4, 21, 3, 14, 5, 5, 20, 3, 12, 3, 3, 3, 3, 9, 4, 4, 4, 2, 5, 5, 3, 20, 3, 12, 5, 2, 20, 9, 10, 3, 9, 5, 6, 4, 9, 3, 7, 5, 9, 11, 2, 2, 22, 7, 3, 2, 10, 4, 2, 9, 9, 15, 6, 11, 6, 7, 2, 4, 3, 3, 8, 2, 6, 5, 10, 8, 15, 7, 9, 5, 13, 9, 8, 5, 2, 11, 7, 18, 10, 3, 3, 3, 3, 3, 8, 2, 5, 4, 12, 4, 8, 8, 6, 2, 34, 14, 6, 3, 3, 7, 2, 3, 13, 4, 7, 2, 8, 9, 2, 5, 12, 2, 10, 11, 7, 5, 2, 18, 4, 3, 11, 6, 10, 4, 6, 2, 4, 4, 15, 5, 12, 7, 5, 21, 3, 7, 2, 11, 8, 4, 18, 4, 8, 2, 30, 2, 6, 3, 23, 2, 5, 3, 10, 4, 21, 4, 7, 7, 5, 3, 19, 3, 6, 2, 3, 10, 4, 8, 2, 3, 26, 4, 4, 2, 9, 8, 2, 9, 2, 5, 15, 4, 9, 3, 4, 2, 4, 36, 6, 7, 22, 6, 6, 3, 2, 13, 9, 10, 3, 5, 3, 9, 11, 10, 4, 3, 15, 6, 10, 4, 7, 6, 8, 2, 14, 3, 3, 9, 14, 4, 9, 4, 4, 5, 7, 4, 9, 10, 3, 3, 3, 2, 15, 2, 10, 6, 21, 4, 6, 12, 5, 2, 5, 6, 3, 2, 2, 10, 4, 13, 5, 12, 2, 14, 14, 7, 4, 4, 14, 2, 2, 2, 4, 2, 4, 2, 9, 9, 3, 2, 5, 2, 3, 11, 2, 27, 3, 7, 3, 5, 3, 5, 3, 3, 2, 7, 8, 4, 28, 10, 5, 6, 3, 5, 10, 13, 5, 135, 8, 8, 3, 5, 10, 6, 15, 6, 11, 10, 4, 6, 4, 6, 5, 11, 2, 2, 2, 2, 20, 5, 17, 9, 2, 2, 2, 4, 2, 4, 5, 5, 3, 4, 8, 4, 8, 2, 15, 3, 2, 8, 6, 2, 2, 2, 9, 4, 18, 8, 3, 3, 7, 2, 3, 8, 6, 2, 9, 8, 2, 9, 3, 9, 14, 5, 5, 6, 5, 3, 2, 4, 3, 9, 9, 3, 2, 8, 6, 7, 2, 8, 8, 6, 4, 5, 2, 10, 2, 4, 10, 14, 4, 3, 6, 3, 3, 5, 2, 6, 7, 18, 2, 17, 2, 7, 15, 7, 8, 2, 14, 2, 8, 2, 12, 3, 3, 5, 7, 8, 2, 5, 3, 12, 7, 2, 3, 3, 17, 2, 2, 6, 5, 3, 2, 4, 7, 4, 2, 2, 5, 3, 4, 2, 10, 10, 6, 3, 6, 2, 7, 4, 4, 6, 6, 2, 3, 4, 2, 5, 2, 2, 7, 5, 5, 4, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 4, 2, 2, 2, 2, 6, 7, 2, 5, 7, 3, 2, 2, 2, 4, 2, 2, 3, 5, 7, 3, 3, 4, 4, 6, 12, 3, 3, 3, 3, 6, 2, 2, 4, 10, 4, 11, 5, 4, 7, 2, 5, 4, 5, 2, 5, 3, 2, 2, 10, 3, 4, 11, 2, 13, 11, 2, 5, 3, 3, 4, 5, 2, 3, 2, 7, 4, 5, 3, 5, 2, 3, 8, 5, 4, 3, 3, 4, 2, 8, 2, 8, 5, 2, 4, 2, 3, 3, 2, 3, 4, 2, 2]

